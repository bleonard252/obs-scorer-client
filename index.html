<!DOCTYPE html>

<head>
	<!-- OBS WebSockets -->
	<script src="https://rawcdn.githack.com/haganbmj/obs-websocket-js/be7810d7d36352df5a29fb996eec648bfaddfa3e/dist/obs-websocket.js"></script>
	<!-- Material Design Lite -->
	<link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.green-blue.min.css" />
	<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
	<script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
	<script src="https://rawcdn.githack.com/GoogleChrome/dialog-polyfill/9abb93c0cf35e96bb6372558398dfe741b69fa24/dist/dialog-polyfill.js"></script>
	<link rel="stylesheet" href="https://rawcdn.githack.com/GoogleChrome/dialog-polyfill/9abb93c0cf35e96bb6372558398dfe741b69fa24/dist/dialog-polyfill.css" />
	<!-- OBS Scorer Client -->
	<title>OBS Scorer Client</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
	<div class="mdl-layout mdl-js-layout mdl-layout--no-drawer mdl-layout--fixed-header">
		<header class="mdl-layout__header">
			<div class="mdl-layout__header-row">
				<span class="mdl-layout-title">OBS Scorer<span class="mdl-layout--large-screen-only"> Client</span></span>
				<div class="mdl-layout-spacer"></div>
				<nav class="mdl-navigation">
					<a class="mdl-navigation__link" href="#"><i class="material-icons">power</i><span class="mdl-layout--large-screen-only">Log Out</span></a>
				</nav>
			</div>
		</header>
		<main class="mdl-layout__content">
			<div class="page-content">
				<div class="mdl-grid">
					<div class="mdl-color--white mdl-card mdl-shadow--2dp mdl-cell mdl-cell--12-col">
						<details><summary><div class="mdl-card__title">
							<h2 class="mdl-card__title-text">Settings</h2>
						</div></summary>
						<div class="mdl-card__supporting-text">
							<!-- Registration-->
							<div>
								<div class="mdl-textfield mdl-js-textfield">
									<input class="mdl-textfield__input" type="text" id="osc--settings--url">
									<label class="mdl-textfield__label" for="osc--settings--url">URL and Port</label>
								</div>
								<div class="mdl-textfield mdl-js-textfield">
									<input class="mdl-textfield__input" type="password" id="osc--settings--password">
									<label class="mdl-textfield__label" for="osc--settings--password">Password (if applicable)</label>
								</div>
								<button class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored" id="osc--settings--login-button">
									Sign In
								</button>
							</div>
							<!-- Scene and Source Name -->
							<div>
								
							</div>
						</div>
					</div></details>
				</div>
			</div>
		</main>
	</div>
	<dialog class="mdl-dialog" id="osc--login-dialog">
		<h4 class="mdl-dialog__title">Log In!</h4>
		<div class="mdl-dialog__content">
			<div class="mdl-textfield mdl-js-textfield">
				<input class="mdl-textfield__input" type="text" id="osc--login-dialog--url">
				<label class="mdl-textfield__label" for="osc--login-dialog--url">URL and Port</label>
			</div>
			<div class="mdl-textfield mdl-js-textfield">
				<input class="mdl-textfield__input" type="password" id="osc--login-dialog--password">
				<label class="mdl-textfield__label" for="osc--login-dialog--password">Password (if applicable)</label>
			</div>
		</div>
		<div class="mdl-dialog__actions">
			<button type="button" class="mdl-button" id="osc--login-dialog--login-button">Log In</button>
		</div>
	</dialog>
	<script>
		const obs = new OBSWebSocket();
		var dialog = document.querySelector('dialog');
		var showDialogButton = document.querySelector('#osc--login-dialog--login-button');
		var urlPort = document.querySelector('#osc--login-dialog--url');
		var passport = document.querySelector('#osc--login-dialog--password');
		if (!dialog.showModal) {
			dialogPolyfill.registerDialog(dialog);
		}
		dialog.showModal();
		urlPort.value = getSetting("urlPort") || "";
		passport.value = getSetting("passport") || "";
		showDialogButton.addEventListener('click', function () {
			obs.connect({ address: urlPort.value, password: passport.value });
			setSetting("urlPort",urlPort.value);
			setSetting("passport",passport.value);
		});
		dialog.querySelector('.close').addEventListener('click', function () {
			dialog.close();
		});
	</script>
	<script>
		function getSetting(opt) {
			let loa = localStorage.getItem("osc--settings");
			let lob = JSON.parse(loa);
			return lob[opt]
		}
		function setSetting(opt,val) {
			let loa = localStorage.getItem("osc--settings") || {};
			let lob = JSON.parse(loa);
			lob[opt] = val;
			let loc = JSON.stringify(lob);
			localStorage.setItem("osc--settings",lob);
		}
	</script>
</body>