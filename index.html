<!DOCTYPE html>

<head>
	<!-- OBS WebSockets -->
	<script src="https://rawcdn.githack.com/haganbmj/obs-websocket-js/be7810d7d36352df5a29fb996eec648bfaddfa3e/dist/obs-websocket.js"></script>
	<!-- Material Design Lite -->
	<link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.green-blue.min.css" />
	<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
	<script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
	<script src="https://rawcdn.githack.com/GoogleChrome/dialog-polyfill/9abb93c0cf35e96bb6372558398dfe741b69fa24/dist/dialog-polyfill.js"></script>
	<link rel="stylesheet" href="https://rawcdn.githack.com/GoogleChrome/dialog-polyfill/9abb93c0cf35e96bb6372558398dfe741b69fa24/dist/dialog-polyfill.css" />
	<!-- OBS Scorer Client -->
	<title>OBS Scorer Client</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<script>const obs = new OBSWebSocket();</script>
</head>
<body>
	<div class="mdl-layout mdl-js-layout mdl-layout--no-drawer mdl-layout--fixed-header">
		<header class="mdl-layout__header">
			<div class="mdl-layout__header-row">
				<span class="mdl-layout-title">OBS Scorer<span class="mdl-layout--large-screen-only"> Client</span></span>
			</div>
		</header>
		<main class="mdl-layout__content">
			<div class="page-content">
				<div class="mdl-grid">
					<div class="mdl-color--white mdl-card mdl-shadow--2dp mdl-cell mdl-cell--12-col mirasize" id="osc--settings-card">
						<details><summary><div class="mdl-card__title">
							<h2 class="mdl-card__title-text">Settings</h2>
						</div></summary>
						<div class="mdl-card__supporting-text">
							<div class="mdl-tabs mdl-js-tabs mdl-js-ripple-effect">
								<div class="mdl-tabs__tab-bar">
									<a href="#osc--settings--connection-panel" class="mdl-tabs__tab is-active">Connection + Sync</a>
									<a href="#osc--settings--away-panel" class="mdl-tabs__tab">Away Team</a>
									<a href="#osc--settings--home-panel" class="mdl-tabs__tab">Home Team</a>
									<a href="#osc--settings--gamestatus-panel" class="mdl-tabs__tab">Game Status</a>
								</div>
								
								<div class="mdl-tabs__panel is-active" id="osc--settings--connection-panel">
									<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
										<input class="mdl-textfield__input" type="text" id="osc--settings--url">
										<label class="mdl-textfield__label" for="osc--settings--url">URL and Port</label>
									</div>
									<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
										<input class="mdl-textfield__input" type="password" id="osc--settings--password">
										<label class="mdl-textfield__label" for="osc--settings--password">Password (if applicable)</label>
									</div>
									<button class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored" id="osc--settings--login-button">
										Sign In
									</button><br />
									<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
										<input class="mdl-textfield__input" type="text" id="osc--settings--settings-holder">
										<label class="mdl-textfield__label" for="osc--settings--settings-holder">Settings Synchronization Source</label>
									</div>
									<button type="button" class="mdl-button mdl-js-button mdl-button--colored" id="osc--settings--sync-button"
										onClick="pushSettings()">Sync (Push)</button>
									<button type="button" class="mdl-button mdl-js-button mdl-button--colored" id="osc--settings--pull-button"
										onClick="pullSettings()">Sync (Pull)</button>
								</div>
								<div class="mdl-tabs__panel" id="osc--settings--away-panel">
									<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
										<input class="mdl-textfield__input" type="text" id="osc--settings--score1">
										<label class="mdl-textfield__label" for="osc--settings--score1">Away Team Score Source</label>
									</div>
									<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label" title="Timeouts are output as dashes.">
										<input class="mdl-textfield__input" type="text" id="osc--settings--timeouts1">
										<label class="mdl-textfield__label" for="osc--settings--timeouts1">Away Team Timeout Dashes Source</label>
									</div>
									<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
										<input class="mdl-textfield__input" type="text" id="osc--settings--image1">
										<label class="mdl-textfield__label" for="osc--settings--image1">Away Team Icon Source</label>
									</div>
									<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
										<input class="mdl-textfield__input" type="text" id="osc--settings--possession1">
										<label class="mdl-textfield__label" for="osc--settings--possession1">Away Team Possession Source</label>
									</div>
									<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
										<input class="mdl-textfield__input" type="text" id="osc--settings--append1">
										<label class="mdl-textfield__label" for="osc--settings--append1">Away Team Top Text Container Source</label>
									</div>
								</div>
								<div class="mdl-tabs__panel" id="osc--settings--home-panel">
									<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
										<input class="mdl-textfield__input" type="text" id="osc--settings--score2">
										<label class="mdl-textfield__label" for="osc--settings--score2">Home Team Score Source</label>
									</div>
									<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label" title="Timeouts are output as dashes.">
										<input class="mdl-textfield__input" type="text" id="osc--settings--timeouts2">
										<label class="mdl-textfield__label" for="osc--settings--timeouts2">Home Team Timeout Dashes Source</label>
									</div>
									<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
										<input class="mdl-textfield__input" type="text" id="osc--settings--image2">
										<label class="mdl-textfield__label" for="osc--settings--image2">Home Team Icon Source</label>
									</div>
									<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
										<input class="mdl-textfield__input" type="text" id="osc--settings--possession2">
										<label class="mdl-textfield__label" for="osc--settings--possession2">Home Team Possession Source</label>
									</div>
									<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
										<input class="mdl-textfield__input" type="text" id="osc--settings--append2">
										<label class="mdl-textfield__label" for="osc--settings--append2">Home Team Top Text Container Source</label>
									</div>
								</div>
								<div class="mdl-tabs__panel" id="osc--settings--gamestatus-panel">
									<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
										<input class="mdl-textfield__input" type="text" id="osc--settings--status">
										<label class="mdl-textfield__label" for="osc--settings--status">Status/Downs Text Source</label>
									</div>
									<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
										<input class="mdl-textfield__input" type="text" id="osc--settings--idle">
										<label class="mdl-textfield__label" for="osc--settings--idle">Basic Status Text</label>
									</div>
									<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
										<input class="mdl-textfield__input" type="text" id="osc--settings--lineage">
										<label class="mdl-textfield__label" for="osc--settings--lineage">Line of Possession Source</label>
									</div>
									<label class="mdl-switch mdl-js-switch mdl-js-ripple-effect" for="osc--settings--status-hide-on-basic">
										<input type="checkbox" id="osc--settings--status-hide-on-basic" class="mdl-switch__input" checked>
										<span class="mdl-switch__label" for="osc--settings--status-hide-on-basic">Hide Status/Downs instead of Basic</span>
									</label>
									<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
										<input class="mdl-textfield__input" type="text" id="osc--settings--status-container">
										<label class="mdl-textfield__label" for="osc--settings--status-container">Status/Downs Container</label>
									</div>
									<!---->
									<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
										<input class="mdl-textfield__input" type="text" id="osc--settings--possession-scene">
										<label class="mdl-textfield__label" for="osc--settings--possession-scene">Possession Scene</label>
									</div>
									<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
										<input class="mdl-textfield__input" type="text" id="osc--settings--append3">
										<label class="mdl-textfield__label" for="osc--settings--append3">Neutral Top Text Container Source</label>
									</div>
									<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
										<input class="mdl-textfield__input" type="text" id="osc--settings--append-text">
										<label class="mdl-textfield__label" for="osc--settings--append-text">Top Text Source</label>
									</div>
									<!---->
									<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
										<input class="mdl-textfield__input" type="text" id="osc--settings--flag-review-scene">
										<label class="mdl-textfield__label" for="osc--settings--flag-review-scene">Flag/Review Scene</label>
									</div>
									<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
										<input class="mdl-textfield__input" type="text" id="osc--settings--flag">
										<label class="mdl-textfield__label" for="osc--settings--flag">Flag Source</label>
									</div>
									<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
										<input class="mdl-textfield__input" type="text" id="osc--settings--review">
										<label class="mdl-textfield__label" for="osc--settings--review">Review Source</label>
									</div>
									<!---->
									<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
										<input class="mdl-textfield__input" type="text" id="osc--settings--quarter">
										<label class="mdl-textfield__label" for="osc--settings--quarter">Quarter Source</label>
									</div>
									<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
										<input class="mdl-textfield__input" type="text" id="osc--settings--clock">
										<label class="mdl-textfield__label" for="osc--settings--clock">Game Clock Source</label>
									</div>
								</div>
							</div>
						</div></details>
					</div>
					<!-- --- -->
					<div class="mdl-color--white mdl-card mdl-shadow--2dp mdl-cell mdl-cell--4-col">
						<div class="mdl-card__title">
							<h2 class="mdl-card__title-text">Scoreboard</h2>
						</div>
						<div class="mdl-card__supporting-text" style="overflow-x:auto">
							<form>
								<table class="mdl-data-table mdl-js-data-table mdl-shadow--2dp">
									<thead>
										<tr>
											<th class="mdl-data-table__cell--non-numeric">Icon</th>
											<!-- <th class="mdl-data-table__cell--non-numeric">Name</th> -->
											<th class="mdl-data-table__cell--non-numeric">Score</th>
											<th class="mdl-data-table__cell--non-numeric">Timeouts</th>
											<th class="mdl-data-table__cell--non-numeric">
												<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="osc--scoreboard--possession__team-0">
													<input type="radio" name="osc--scoreboard--possession" class="mdl-radio__button" id="osc--scoreboard--possession__team-0" value="0" checked>
												</label>
											</th>
										</tr>
									</thead>
									<tbody>
										<tr>
											<td class="mdl-data-table__cell--non-numeric"><img id="osc--scoreboard--icon__team-1" style="width: 48px" /></td>
											<td>
												<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label" style="width:24px">
													<input class="mdl-textfield__input" type="number" pattern="[0-9]*(\.[0-9]+)?" id="osc--scoreboard--score__team-1">
													<label class="mdl-textfield__label" for="osc--scoreboard--score__team-1">Pts</label>
													<span class="mdl-textfield__error">Invalid!</span>
												</div>
											</td>
											<td style="min-width:256px"><input class="mdl-slider mdl-js-slider" id="osc--scoreboard--timeouts__team-1" type="range" min="0" max="3" value="3" tabindex="0"></td>
											<td>
												<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="osc--scoreboard--possession__team-1">
													<input type="radio" name="osc--scoreboard--possession" class="mdl-radio__button" id="osc--scoreboard--possession__team-1" value="1">
												</label>
											</td>
										</tr>
										<tr>
											<td class="mdl-data-table__cell--non-numeric"><img id="osc--scoreboard--icon__team-2" style="width: 48px" /></td>
											<td>
												<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label" style="width:24px">
													<input class="mdl-textfield__input" type="number" pattern="[0-9]*(\.[0-9]+)?" id="osc--scoreboard--score__team-2">
													<label class="mdl-textfield__label" for="osc--scoreboard--score__team-2">Pts</label>
													<span class="mdl-textfield__error">Invalid!</span>
												</div>
											</td>
											<td style="min-width:256px"><input class="mdl-slider mdl-js-slider" id="osc--scoreboard--timeouts__team-2" type="range" min="0" max="3" value="3" tabindex="0"></td>
											<td>
												<label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="osc--scoreboard--possession__team-2">
													<input type="radio" name="osc--scoreboard--possession" class="mdl-radio__button" id="osc--scoreboard--possession__team-2" value="2">
												</label>
											</td>
										</tr>
									</tbody>
								</table>
							</form>
							<script>
								obs.on("AuthenticationSuccess",() => {
									obs.send("GetSourceSettings",{"sourceName": getSetting("score1").split(/,[ ]?/)[0]}).then((data) => {document.querySelector("#osc--scoreboard--score__team-1").value = data.sourceSettings.text});
									obs.send("GetSourceSettings",{"sourceName": getSetting("score2").split(/,[ ]?/)[0]}).then((data) => {document.querySelector("#osc--scoreboard--score__team-2").value = data.sourceSettings.text});
									obs.send("GetSourceSettings",{"sourceName": getSetting("timeouts1").split(/,[ ]?/)[0]}).then((data) => {document.querySelector("#osc--scoreboard--timeouts__team-1").MaterialSlider.change(data.sourceSettings.text.match(/-/g) || [].length)});
									obs.send("GetSourceSettings",{"sourceName": getSetting("timeouts2").split(/,[ ]?/)[0]}).then((data) => {document.querySelector("#osc--scoreboard--timeouts__team-2").MaterialSlider.change(data.sourceSettings.text.match(/-/g) || [].length)});
									obs.send("GetSourceSettings",{"sourceName": getSetting("quarter").split(/,[ ]?/)[0]}).then((data) => {
										document.querySelectorAll("#osc--clock--qtr>*").forEach((g) => g.classList.remove("mdl-button--colored")); 
										document.querySelector("#osc--clock--qtr__"+data.sourceSettings.text.replace(/ST|ND|RD|TH/,"").replace("OT","ot")).classList.add("mdl-button--colored")});
									obs.send("GetSourceSettings",{"sourceName": getSetting("clock-source").split(/,[ ]?/)[0]}).then((data) => {document.querySelector("#osc--clock--time").value = data.sourceSettings.text});
									obs.send("GetSceneItemProperties",
										{"scene-name": getSetting("possession-scene").split(/,[ ]?/)[0], 
										"item": getSetting("possession1").split(/,[ ]?/)[0]}).then((data) => 
											{document.querySelector("#osc--scoreboard--possession__team-1").checked = data.visible});
									obs.send("GetSceneItemProperties",
										{"scene-name": getSetting("possession-scene").split(/,[ ]?/)[0], 
										"item": getSetting("possession2").split(/,[ ]?/)[0]}).then((data) => 
											{document.querySelector("#osc--scoreboard--possession__team-2").checked = data.visible});
									obs.send("GetSourceSettings",{"sourceName": getSetting("image1").split(/,[ ]?/)[0]}).then((data) => {document.querySelector("#osc--scoreboard--icon__team-1").src = data.sourceSettings.file});
									obs.send("GetSourceSettings",{"sourceName": getSetting("image2").split(/,[ ]?/)[0]}).then((data) => {document.querySelector("#osc--scoreboard--icon__team-2").src = data.sourceSettings.file});
									// ---
									document.querySelector("#osc--scoreboard--score__team-1").addEventListener("blur",(e) => {
										getSetting("score1").split(/,[ ]?/).forEach((h) => obs.send("SetSourceSettings",{"sourceName":h,"sourceSettings": {"text":e.target.value}}))
									});
									document.querySelector("#osc--scoreboard--score__team-2").addEventListener("blur",(e) => {
										getSetting("score2").split(/,[ ]?/).forEach((h) => obs.send("SetSourceSettings",{"sourceName":h,"sourceSettings": {"text":e.target.value}}))
									});
									document.querySelector("#osc--scoreboard--timeouts__team-1").addEventListener("input",(e) => {
										getSetting("timeouts1").split(/,[ ]?/).forEach((h) => {
											let x;
											if (e.target.value == 1) x = "-";
											else if (e.target.value == 2) x = "- -";
											else if (e.target.value == 3) x = "- - -";
											else x = " ";
											obs.send("SetSourceSettings",{"sourceName":h,"sourceSettings": {"text":x}})
										})
									});
									document.querySelector("#osc--scoreboard--timeouts__team-2").addEventListener("input",(e) => {
										getSetting("timeouts2").split(/,[ ]?/).forEach((h) => {
											let x;
											if (e.target.value == 1) x = "-";
											else if (e.target.value == 2) x = "- -";
											else if (e.target.value == 3) x = "- - -";
											else x = " ";
											obs.send("SetSourceSettings",{"sourceName":h,"sourceSettings": {"text":x}})
										})
									});
									document.querySelector("#osc--scoreboard--possession__team-0").addEventListener("blur",(e) => {
										obs.send("SetSceneItemProperties",{"scene-name":getSetting("possession-scene").split(/,[ ]?/)[0],
											"item": getSetting("possession1").split(/,[ ]?/)[0], "visible": false});
										obs.send("SetSceneItemProperties",{"scene-name":getSetting("possession-scene").split(/,[ ]?/)[0],
											"item": getSetting("possession2").split(/,[ ]?/)[0], "visible": false})
									});
									document.querySelector("#osc--scoreboard--possession__team-1").addEventListener("blur",(e) => {
										obs.send("SetSceneItemProperties",{"scene-name":getSetting("possession-scene").split(/,[ ]?/)[0],
											"item": getSetting("possession1").split(/,[ ]?/)[0], "visible": e.target.checked});
											obs.send("SetSceneItemProperties",{"scene-name":getSetting("possession-scene").split(/,[ ]?/)[0],
											"item": getSetting("possession2").split(/,[ ]?/)[0], "visible": false})
									});
									document.querySelector("#osc--scoreboard--possession__team-2").addEventListener("blur",(e) => {
										obs.send("SetSceneItemProperties",{"scene-name":getSetting("possession-scene").split(/,[ ]?/)[0],
											"item": getSetting("possession1").split(/,[ ]?/)[0], "visible": false});
										obs.send("SetSceneItemProperties",{"scene-name":getSetting("possession-scene").split(/,[ ]?/)[0],
											"item": getSetting("possession2").split(/,[ ]?/)[0], "visible": e.target.checked})
									});
									document.querySelector("#osc--status--flag").addEventListener("blur",(e) => {
										clearStatus();
										obs.send("SetSceneItemProperties",{"scene-name":getSetting("flag-review-scene").split(/,[ ]?/)[0],
											"item": getSetting("flag").split(/,[ ]?/)[0], "visible": true});
									});
									document.querySelector("#osc--status--review").addEventListener("blur",(e) => {
										clearStatus();
										obs.send("SetSceneItemProperties",{"scene-name":getSetting("flag-review-scene").split(/,[ ]?/)[0],
											"item": getSetting("review").split(/,[ ]?/)[0], "visible": true});
									});
									document.querySelector("#osc--status--clear").addEventListener("blur",(e) => {
										clearStatus();
									});
									document.querySelector("#osc--clock--time").addEventListener("blur",(e) => {
										getSetting("clock-source").split(/,[ ]?/).forEach((h) => obs.send("SetSourceSettings",{"sourceName":h,"sourceSettings": {"text":e.target.value}}).catch((e) => console.warn("[clock updater hook] failure to update clock", e)))
									});
								})
							</script>
						</div>
					</div>
					<div class="mdl-color--white mdl-card mdl-shadow--2dp mdl-cell mdl-cell--4-col">
						<div class="mdl-card__title">
							<h2 class="mdl-card__title-text">Game Status</h2>
						</div>
						<div class="mdl-card__supporting-text">
							<div id="osc--status--down">
								<button class="mdl-button mdl-js-button mdl-button--icon mdl-button--colored" id="osc--status--down__1">1</button>
								<button class="mdl-button mdl-js-button mdl-button--icon" id="osc--status--down__2">2</button>
								<button class="mdl-button mdl-js-button mdl-button--icon" id="osc--status--down__3">3</button>
								<button class="mdl-button mdl-js-button mdl-button--icon" id="osc--status--down__4">4</button>
								Down
							</div>
							<div>
								& <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label" style="width:48px">
									<label class="mdl-textfield__label" for="osc--status--yards">Yards to Go</label>
									<input class="mdl-textfield__input" type="number" pattern="[0-9]*(\.[0-9]+)?|GOAL|INCHES|IN|LONG|MED|MEDIUM|SHORT" id="osc--status--yards">
								</div> yards
								<button class="mdl-button mdl-js-button" id="osc--status--goal">GOAL</button>
								<button class="mdl-button mdl-js-button" id="osc--status--inches">INCHES</button>
								<br />
								<button class="mdl-button mdl-js-button mdl-button--icon mdl-color-text--green" id="osc--status--add-1" onclick="modstatus(1)">1</button>
								<button class="mdl-button mdl-js-button mdl-button--icon mdl-color-text--green" id="osc--status--add-5" onclick="modstatus(5)">5</button>
								<button class="mdl-button mdl-js-button mdl-button--icon mdl-color-text--green" id="osc--status--add-10" onclick="modstatus(10)">10</button>
								<button class="mdl-button mdl-js-button mdl-button--icon mdl-color-text--green" id="osc--status--add-50" onclick="modstatus(50)">50</button>
								<br />
								<button class="mdl-button mdl-js-button mdl-button--icon mdl-color-text--red" id="osc--status--remove-1" onclick="modstatus(-1)">1</button>
								<button class="mdl-button mdl-js-button mdl-button--icon mdl-color-text--red" id="osc--status--remove-5" onclick="modstatus(-5)">5</button>
								<button class="mdl-button mdl-js-button mdl-button--icon mdl-color-text--red" id="osc--status--remove-10" onclick="modstatus(-10)">10</button>
								<button class="mdl-button mdl-js-button mdl-button--icon mdl-color-text--red" id="osc--status--remove-50" onclick="modstatus(-50)">50</button>
								<br />
								<button class="mdl-button mdl-js-button" id="osc--status--update" onClick="clearStatus()">SEND</button>
							</div>
							<script>
								var specialStatus = () => {};
								var firstn10 = () => {};
								var clearStatus = () => {};
								obs.on("AuthenticationSuccess",() => {
									document.querySelectorAll("#osc--status--down>*").forEach((h) => { //toggles the four thingies
										h.addEventListener("click", (f) => {
											document.querySelectorAll("#osc--status--down>*").forEach((g) => g.classList.remove("mdl-button--colored"));
											f.target.className += " mdl-button--colored";
										})
									})
									function lx(e) { //update the status thingy
										let x1 = document.querySelector("#osc--status--down .mdl-button--colored").innerHTML;
										x1 = x1.replace("1","1ST");
										x1 = x1.replace("2","2ND");
										x1 = x1.replace("3","3RD");
										x1 = x1.replace("4","4TH");
										let x2 = document.querySelector("#osc--status--yards").value;
										getSetting("status-source").split(/,[ ]?/).forEach((h) => obs.send("SetSourceSettings",{"sourceName":h,"sourceSettings": {"text":x1+" & "+x2}}));
									}
									function lx2(e) { //update the status thingy
										let x1 = document.querySelector("#osc--status--down .mdl-button--colored").innerHTML;
										x1 = x1.replace("1","1ST");
										x1 = x1.replace("2","2ND");
										x1 = x1.replace("3","3RD");
										x1 = x1.replace("4","4TH");
										let x2 = 
											e.target.id.includes("goal") ? "GOAL" :
											e.target.id.includes("inches") ? "INCHES" :
											"???";
										getSetting("status-source").split(/,[ ]?/).forEach((h) => obs.send("SetSourceSettings",{"sourceName":h,"sourceSettings": {"text":x1+" & "+x2}}));
									}
									document.getElementById("osc--status--yards").addEventListener("blur", lx);
									document.getElementById("osc--status--update").addEventListener("click", lx);
									document.getElementById("osc--status--goal").addEventListener("click", lx2);
									document.getElementById("osc--status--inches").addEventListener("click", lx2);
									var idled = false
									specialStatus = (text) => {
										console.log("E")
										if (getSetting('status-hide-on-basic') && text == getSetting('idle').toUpperCase()) {
											obs.send("SetSceneItemProperties",{"scene-name":getSetting("flag-review-scene").split(/,[ ]?/)[0],
											"item": getSetting("status-container").split(/,[ ]?/)[0], "visible": false});
											idled = true; 
										} else {
											getSetting("status-source").split(/,[ ]?/).forEach((h) => obs.send("SetSourceSettings",{"sourceName":h,"sourceSettings": {"text":text}}));
											obs.send("SetSceneItemProperties",{"scene-name":getSetting("flag-review-scene").split(/,[ ]?/)[0],
											"item": getSetting("status-container").split(/,[ ]?/)[0], "visible": true});
										}
									}
									firstn10 = () => {
										document.querySelectorAll("#osc--status--down>*").forEach((g) => g.classList.remove("mdl-button--colored"));
										document.querySelector("#osc--status--down>*").classList.add("mdl-button--colored");
										document.querySelector("#osc--status--yards").value = "10";
										obs.send("SetSceneItemProperties",{"scene-name":getSetting("flag-review-scene").split(/,[ ]?/)[0],
											"item": getSetting("status-container").split(/,[ ]?/)[0], "visible": true});
									}
									clearStatus = () => {
										obs.send("SetSceneItemProperties",{"scene-name":getSetting("flag-review-scene").split(/,[ ]?/)[0],
											"item": getSetting("flag").split(/,[ ]?/)[0], "visible": false});
										obs.send("SetSceneItemProperties",{"scene-name":getSetting("flag-review-scene").split(/,[ ]?/)[0],
											"item": getSetting("review").split(/,[ ]?/)[0], "visible": false});
										if (!idled) obs.send("SetSceneItemProperties",{"scene-name":getSetting("flag-review-scene").split(/,[ ]?/)[0],
											"item": getSetting("status-container").split(/,[ ]?/)[0], "visible": true});
										else idled = false
									}
								})
								function modstatus(by) {
									const yards = document.querySelector("#osc--status--yards");
									yards.value = (Number(yards.value) + by).toString();
									// don't push status; that way you can fine tune it more
								}
							</script>
							<div>
								<button class="mdl-button mdl-js-button mdl-button--colored" id="osc--status--idle"
									onclick="specialStatus(getSetting('idle').toUpperCase());clearStatus();">BASIC</button>
								<button class="mdl-button mdl-js-button mdl-button--colored" id="osc--status--reset"
									onclick="specialStatus('1ST & 10');firstn10();clearStatus();">RESET</button>
								<br />
								<button class="mdl-button mdl-js-button mdl-color-text--amber" id="osc--status--flag"
									onclick="specialStatus('FLAG')">FLAG</button>
								<button class="mdl-button mdl-js-button mdl-color-text--amber" id="osc--status--review"
									onclick="specialStatus('REVIEW')">REVIEW</button>
								<button class="mdl-button mdl-js-button" id="osc--status--clear">CLEAR</button>
							</div>
						</div>
					</div>
					<div class="mdl-color--white mdl-card mdl-shadow--2dp mdl-cell mdl-cell--4-col">
						<div class="mdl-card__title">
							<h2 class="mdl-card__title-text">Clock</h2>
						</div>
						<div class="mdl-card__supporting-text">
							<div id="osc--clock--qtr">
								<button class="mdl-button mdl-js-button mdl-button--icon mdl-button--colored" id="osc--clock--qtr__1">1</button>
								<button class="mdl-button mdl-js-button mdl-button--icon" id="osc--clock--qtr__2">2</button>
								<button class="mdl-button mdl-js-button mdl-button--icon" id="osc--clock--qtr__3">3</button>
								<button class="mdl-button mdl-js-button mdl-button--icon" id="osc--clock--qtr__4">4</button>
								<button class="mdl-button mdl-js-button mdl-button--icon" id="osc--clock--qtr__OT">OT</button>
								Qtr
							</div>
							<div>
								<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label" style="width:192px">
									<input class="mdl-textfield__input" type="text" pattern="[0-9][0-9]?:[0-9]{2}" id="osc--clock--time">
									<label class="mdl-textfield__label" for="osc--clock--time">Clock</label>
									<span class="mdl-textfield__error">Not valid!</span>
								</div><br />
								<button class="mdl-button mdl-js-button mdl-color-text--green" id="osc--clock--start">START</button>
								<button class="mdl-button mdl-js-button mdl-color-text--red" id="osc--clock--stop">STOP</button>
								<br />
								<button class="mdl-button mdl-js-button mdl-button--icon mdl-color-text--green" id="osc--clock--add-1" onclick="modclock(1)">1</button>
								<button class="mdl-button mdl-js-button mdl-button--icon mdl-color-text--green" id="osc--clock--add-5" onclick="modclock(5)">5</button>
								<button class="mdl-button mdl-js-button mdl-button--icon mdl-color-text--green" id="osc--clock--add-10" onclick="modclock(10)">10</button>
								<button class="mdl-button mdl-js-button mdl-button--icon mdl-color-text--green" id="osc--clock--add-30" onclick="modclock(30)">30</button>
								<button class="mdl-button mdl-js-button mdl-button--icon mdl-color-text--green" id="osc--clock--add-30" onclick="modclock(60)">60</button>
								<br />
								<button class="mdl-button mdl-js-button mdl-button--icon mdl-color-text--red" id="osc--clock--remove-1" onclick="modclock(-1)">1</button>
								<button class="mdl-button mdl-js-button mdl-button--icon mdl-color-text--red" id="osc--clock--remove-5" onclick="modclock(-5)">5</button>
								<button class="mdl-button mdl-js-button mdl-button--icon mdl-color-text--red" id="osc--clock--remove-10" onclick="modclock(-10)">10</button>
								<button class="mdl-button mdl-js-button mdl-button--icon mdl-color-text--red" id="osc--clock--remove-30" onclick="modclock(-30)">30</button>
								<button class="mdl-button mdl-js-button mdl-button--icon mdl-color-text--red" id="osc--clock--remove-30" onclick="modclock(-60)">60</button>
								<br />
								<button class="mdl-button mdl-js-button mdl-color-text--gray" id="osc--clock--set-0" onclick="setclock(0)">:00</button>
								<button class="mdl-button mdl-js-button mdl-color-text--gray" id="osc--clock--set-15" onclick="setclock(15)">:15</button>
								<button class="mdl-button mdl-js-button mdl-color-text--gray" id="osc--clock--set-30" onclick="setclock(30)">:30</button>
								<button class="mdl-button mdl-js-button mdl-color-text--gray" id="osc--clock--set-45" onclick="setclock(45)">:45</button>
							</div>
						</div>
						<script>
							var timer;
							document.querySelectorAll("#osc--clock--qtr>*").forEach((h) => { //toggles the five thingies
								h.addEventListener("click", (f) => {
									document.querySelectorAll("#osc--clock--qtr>*").forEach((g) => g.classList.remove("mdl-button--colored"));
									f.target.className += " mdl-button--colored";
								})
							})
							function lx2(e) { //update the quarter
								let x1 = document.querySelector("#osc--clock--qtr .mdl-button--colored").innerHTML;
								x1 = x1.replace("1","1ST");
								x1 = x1.replace("2","2ND");
								x1 = x1.replace("3","3RD");
								x1 = x1.replace("4","4TH");
								//getSetting("status-source").split(/,[ ]?/).forEach((h) => obs.send("SetSourceSettings",{"sourceName":h,"sourceSettings": {"text":x1+" & "+x2}}));
								getSetting("quarter").split(/,[ ]?/).forEach((h) => obs.send("SetSourceSettings",{"sourceName":h,"sourceSettings": {"text":x1}}).catch((e) => console.error("[lx2] update failed", e)));
							}
							document.querySelectorAll("#osc--clock--qtr>button").forEach((i) => i.addEventListener("click", lx2));
							// ---
							function pushClock() {
								const clock = document.getElementById("osc--clock--time");
								getSetting("clock-source").split(/,[ ]?/).forEach((h) => obs.send("SetSourceSettings",{"sourceName":h,"sourceSettings": {"text":clock.value}}).catch((e) => console.error("[pushClock] update failed", e)));
							}
							document.getElementById("osc--clock--start").addEventListener("click",function() {
								const clock = document.getElementById("osc--clock--time");
								if (!timer) timer = setInterval(() => {
									if (!clock.value.match(/[0-9][0-9]?:[0-9]{2}/) || clock.value == "0:00") return clearInterval(timer);
									// let cz = clock.value.split(":");
									// let cm = +cz[0];
									// let cs = +cz[1];
									// let ca = cs + (cm * 60);
									// ca -= 1; // this is where one second is actually subtracted from the clock
									// let cc = (ca % 60).toString();
									// if (cc.length == 1) cc = "0" + cc;
									// let cb = Math.floor(ca / 60).toString() + ":" + cc;
									// clock.value = cb;
									// pushClock();
									// return true;
									modclock(-1);
								}, 1000)
							})
							document.getElementById("osc--clock--stop").addEventListener("click",function() {
								clearInterval(timer);
								timer = null;
								return;
							});
							// set, add, removes
							function modclock(to) {
								const clock = document.getElementById("osc--clock--time");
								if (!clock.value.match(/[0-9][0-9]?:[0-9]{2}/)) return false;
								let cz = clock.value.split(":");
								let cm = +cz[0];
								let cs = +cz[1];
								let ca = cs + (cm * 60);
								ca = ca + to;
								let cc = (ca % 60).toString();
								if (cc.length == 1) cc = "0" + cc;
								let cb = Math.floor(ca / 60).toString() + ":" + cc;
								clock.value = cb;
								pushClock();
								return true;
							}
							function setclock(to) {
								const clock = document.getElementById("osc--clock--time");
								if (!clock.value.match(/[0-9][0-9]?:[0-9]{2}/)) return false;
								let cz = clock.value.split(":");
								cz[1] = to.toString()
								let cm = +cz[0];
								let cs = +cz[1];
								let ca = cs + (cm * 60);
								let cc = (ca % 60).toString();
								if (cc.length == 1) cc = "0" + cc;
								let cb = Math.floor(ca / 60).toString() + ":" + cc;
								clock.value = cb;
								pushClock();
								return true;
							}
						</script>
					</div>
					<div class="mdl-color--white mdl-card mdl-shadow--2dp mdl-cell mdl-cell--4-col">
						<div class="mdl-card__title">
							<h2 class="mdl-card__title-text">Top Text</h2>
						</div>
						<div class="mdl-card__supporting-text">
							<div class="mdl-textfield mdl-js-textfield">
								<input class="mdl-textfield__input" type="text" id="osc--append--text" style="width:100%">
								<label class="mdl-textfield__label" for="osc--append--text">Use text...</label>
							</div>
							<div id="osc--append--presets">
								<button class="mdl-button mdl-js-button mdl-js-ripple-effect" data-osc-preset="timeout">Timeout</button>
							</div>
							<div id="osc--append--actions">
								<button class="mdl-button mdl-js-button mdl-js-ripple-effect" id="osc--append--neutral-button">Neutral</button>
								<button class="mdl-button mdl-js-button mdl-js-ripple-effect" id="osc--append--away-button">Away</button>
								<button class="mdl-button mdl-js-button mdl-js-ripple-effect" id="osc--append--home-button">Home</button>
								<button class="mdl-button mdl-js-button mdl-js-ripple-effect" id="osc--append--clear-button">Clear</button>
							</div>
						</div>
						<script>
							/**
							* @param {Event} e
							*/
							function append(e) {
								//getSetting("append1") //append away. 1 is away, 2 is home, 3 is neutral
								getSetting("append-text").split(/,[ ]?/).forEach((h) => obs.send("SetSourceSettings",{"sourceName":h,"sourceSettings": {"text":document.getElementById("osc--append--text").value}}));
								if (e.currentTarget.id == "osc--append--away-button") obs.send("SetSceneItemProperties",{"scene-name":getSetting("possession-scene").split(/,[ ]?/)[0],
								"item": getSetting("append1").split(/,[ ]?/)[0], "visible": true});
								if (e.currentTarget.id == "osc--append--home-button") obs.send("SetSceneItemProperties",{"scene-name":getSetting("possession-scene").split(/,[ ]?/)[0],
								"item": getSetting("append2").split(/,[ ]?/)[0], "visible": true});
								if (e.currentTarget.id == "osc--append--neutral-button") obs.send("SetSceneItemProperties",{"scene-name":getSetting("possession-scene").split(/,[ ]?/)[0],
								"item": getSetting("append3").split(/,[ ]?/)[0], "visible": true});
							}
							function clearAppend() {
								obs.send("SetSceneItemProperties",{"scene-name":getSetting("possession-scene").split(/,[ ]?/)[0],
								"item": getSetting("append1").split(/,[ ]?/)[0], "visible": false});
								obs.send("SetSceneItemProperties",{"scene-name":getSetting("possession-scene").split(/,[ ]?/)[0],
								"item": getSetting("append2").split(/,[ ]?/)[0], "visible": false});
								obs.send("SetSceneItemProperties",{"scene-name":getSetting("possession-scene").split(/,[ ]?/)[0],
								"item": getSetting("append3").split(/,[ ]?/)[0], "visible": false});
							}
							document.getElementById("osc--append--neutral-button").addEventListener("click", append);
							document.getElementById("osc--append--home-button").addEventListener("click", append);
							document.getElementById("osc--append--away-button").addEventListener("click", append);
							document.getElementById("osc--append--clear-button").addEventListener("click", clearAppend);
						</script>
					</div>
				</div>
			</div>
		</main>
	</div>
	<dialog class="mdl-dialog" id="osc--login-dialog" style="transform: translate(-50%,-50%);top: 50%;left: 50%;right: unset;">
		<h4 class="mdl-dialog__title">Log In!</h4>
		<div class="mdl-dialog__content">
			<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
				<input class="mdl-textfield__input" type="text" id="osc--login-dialog--url">
				<label class="mdl-textfield__label" for="osc--login-dialog--url">URL and Port</label>
			</div>
			<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
				<input class="mdl-textfield__input" type="password" id="osc--login-dialog--password">
				<label class="mdl-textfield__label" for="osc--login-dialog--password">Password (if applicable)</label>
			</div>
		</div>
		<div class="mdl-dialog__actions">
			<button type="button" class="mdl-button close" id="osc--login-dialog--login-button">Log In</button>
		</div>
	</dialog>
	<script>
		function getSetting(opt) {
			if (opt == "urlPort" || opt == "passport" || opt == "settingHolder") return localStorage.getItem("osc--"+opt);
			let loa = localStorage.getItem("osc--settings") || "{}";
			let lob = JSON.parse(loa);
			return lob[opt] || ""
		}
		function setSetting(opt,val) {
			if (opt == "urlPort" || opt == "passport" || opt == "settingHolder") return localStorage.setItem("osc--"+opt,val);
			let loa = localStorage.getItem("osc--settings") || "{}";
			let lob = JSON.parse(loa);
			lob[opt] = val;
			let loc = JSON.stringify(lob);
			return localStorage.setItem("osc--settings",loc);
		}
		function pushSettings() {if (localStorage.getItem("osc--settingHolder").length) try {obs.send("SetSourceSettings",{"sourceName": localStorage.getItem("osc--settingHolder"),"sourceSettings": {"text":localStorage.getItem("osc--settings")}}).catch((e) => console.warn("[pushSettings] push settings failed", e))} catch(e) {console.warn("[pushSettings] push settings failed", e)} else console.log("[pushSettings] Nowhere to sync, not syncing.")}
		function pullSettings() {try {obs.send("GetSourceSettings",{"sourceName": localStorage.getItem("osc--settingHolder")}).then((data) => {localStorage.setItem("osc--settings",data.sourceSettings.text)}).catch((e) => console.warn("[pullSettings] pull settings failed", e));} catch(e) {console.warn("[pullSettings] pull settings failed", e)}}
	</script>
	<style>
		.mdl-layout__container {z-index: 0}
		.mirasize {
			min-height: unset;
		}
		summary {
			display: block
		}
		summary h2::after {
			font-family: "Material Icons";
			content: "expand_less";
			font-size: 24px;
		}
		details[open] summary h2::after {
			font-family: "Material Icons";
			content: "expand_more";
			font-size: 24px;
		}
	</style>
	<script>
		var dialog = document.querySelector('dialog');
		var showDialogButton = document.querySelector('#osc--login-dialog--login-button');
		var settingsLogin = document.querySelector('#osc--settings--login-button');
		var urlPort = document.querySelector('#osc--login-dialog--url');
		var passport = document.querySelector('#osc--login-dialog--password');
		var urlPort2 = document.querySelector('#osc--settings--url');
		var passport2 = document.querySelector('#osc--settings--password');
		//if (!dialog.showModal) {
			dialogPolyfill.registerDialog(dialog);
		//}
		dialog.showModal();
		urlPort.value = getSetting("urlPort") || "localhost:4444";
		passport.value = getSetting("passport") || "";
		urlPort2.value = getSetting("urlPort") || "localhost:4444";
		passport2.value = getSetting("passport") || "";
		showDialogButton.addEventListener('click', function () {
			obs.connect({ address: urlPort.value, password: passport.value });
			setSetting("urlPort",urlPort.value);
			setSetting("passport",passport.value);
			//try {obs.send("GetSourceSettings",{"sourceName": localStorage.getItem("osc--settingHolder")}).then((data) => {localStorage.setItem("osc--settingHolder",data.sourceSettings.text)});} catch(e) {console.warn("[login/dialog] pull settings failed", e)}
		});
		settingsLogin.addEventListener('click', function () {
			obs.connect({ address: urlPort2.value, password: passport2.value });
			setSetting("urlPort",urlPort2.value);
			setSetting("passport",passport2.value);
			//try {obs.send("GetSourceSettings",{"sourceName": localStorage.getItem("osc--settingHolder")}).then((data) => {localStorage.setItem("osc--settingHolder",data.sourceSettings.text)});} catch(e) {console.warn("[login/settings] pull settings failed", e)}
		});
		dialog.querySelector('.close').addEventListener('click', function () {
			dialog.close();
		});
		obs.on('error', err => {
			console.error('[obs] socket error:', err);
		});
	</script>
	<script>
		//# Setting Field Scripts
		document.querySelector("#osc--settings--settings-holder").value = localStorage.getItem("osc--settingHolder") || "";
		document.querySelector("#osc--settings--score1").value = getSetting("score1") || "";
		document.querySelector("#osc--settings--score2").value = getSetting("score2") || "";
		document.querySelector("#osc--settings--timeouts1").value = getSetting("timeouts1") || "";
		document.querySelector("#osc--settings--timeouts2").value = getSetting("timeouts2") || "";
		document.querySelector("#osc--settings--image1").value = getSetting("image1") || "";
		document.querySelector("#osc--settings--image2").value = getSetting("image2") || "";
		document.querySelector("#osc--settings--append1").value = getSetting("append1") || "";
		document.querySelector("#osc--settings--append2").value = getSetting("append2") || "";
		document.querySelector("#osc--settings--append3").value = getSetting("append3") || "";
		document.querySelector("#osc--settings--append-text").value = getSetting("append-text") || "";
		document.querySelector("#osc--settings--status").value = getSetting("status-source") || "";
		document.querySelector("#osc--settings--idle").value = getSetting("idle") || "";
		document.querySelector("#osc--settings--status-hide-on-basic").checked = getSetting("status-hide-on-basic") || "";
		document.querySelector("#osc--settings--status-container").value = getSetting("status-container") || "";
		document.querySelector("#osc--settings--lineage").value = getSetting("lineage") || "";
		document.querySelector("#osc--settings--possession-scene").value = getSetting("possession-scene") || "";
		document.querySelector("#osc--settings--possession1").value = getSetting("possession1") || "";
		document.querySelector("#osc--settings--possession2").value = getSetting("possession2") || "";
		document.querySelector("#osc--settings--flag-review-scene").value = getSetting("flag-review-scene") || "";
		document.querySelector("#osc--settings--flag").value = getSetting("flag") || "";
		document.querySelector("#osc--settings--review").value = getSetting("review") || "";
		document.querySelector("#osc--settings--quarter").value = getSetting("quarter") || "";
		document.querySelector("#osc--settings--clock").value = getSetting("clock-source") || "";
		// ---
		document.querySelector("#osc--settings--settings-holder").addEventListener("blur",(e) => {localStorage.setItem("osc--settingHolder",e.target.value)});
		document.querySelector("#osc--settings--score1").addEventListener("blur",(e) => {setSetting("score1",e.target.value)});
		document.querySelector("#osc--settings--score2").addEventListener("blur",(e) => {setSetting("score2",e.target.value)});
		document.querySelector("#osc--settings--timeouts1").addEventListener("blur",(e) => {setSetting("timeouts1",e.target.value)});
		document.querySelector("#osc--settings--timeouts2").addEventListener("blur",(e) => {setSetting("timeouts2",e.target.value)});
		document.querySelector("#osc--settings--image1").addEventListener("blur",(e) => {setSetting("image1",e.target.value)});
		document.querySelector("#osc--settings--image2").addEventListener("blur",(e) => {setSetting("image2",e.target.value)});
		document.querySelector("#osc--settings--append1").addEventListener("blur",(e) => {setSetting("append1",e.target.value)});
		document.querySelector("#osc--settings--append2").addEventListener("blur",(e) => {setSetting("append2",e.target.value)});
		document.querySelector("#osc--settings--append3").addEventListener("blur",(e) => {setSetting("append3",e.target.value)});
		document.querySelector("#osc--settings--append-text").addEventListener("blur",(e) => {setSetting("append-text",e.target.value)});
		document.querySelector("#osc--settings--status").addEventListener("blur",(e) => {setSetting("status-source",e.target.value)});
		document.querySelector("#osc--settings--idle").addEventListener("blur",(e) => {setSetting("idle",e.target.value)});
		document.querySelector("#osc--settings--status-hide-on-basic").addEventListener("blur",(e) => {setSetting("status-hide-on-basic",e.target.checked)});
		document.querySelector("#osc--settings--status-container").addEventListener("blur",(e) => {setSetting("status-container",e.target.value)});
		document.querySelector("#osc--settings--lineage").addEventListener("blur",(e) => {setSetting("lineage",e.target.value)});
		document.querySelector("#osc--settings--possession1").addEventListener("blur",(e) => {setSetting("possession1",e.target.value)});
		document.querySelector("#osc--settings--possession2").addEventListener("blur",(e) => {setSetting("possession2",e.target.value)});
		document.querySelector("#osc--settings--possession-scene").addEventListener("blur",(e) => {setSetting("possession-scene",e.target.value)});
		document.querySelector("#osc--settings--flag-review-scene").addEventListener("blur",(e) => {setSetting("flag-review-scene",e.target.value)});
		document.querySelector("#osc--settings--flag").addEventListener("blur",(e) => {setSetting("flag",e.target.value)});
		document.querySelector("#osc--settings--review").addEventListener("blur",(e) => {setSetting("review",e.target.value)});
		document.querySelector("#osc--settings--quarter").addEventListener("blur",(e) => {setSetting("quarter",e.target.value)});
		document.querySelector("#osc--settings--clock").addEventListener("blur",(e) => {setSetting("clock-source",e.target.value)});
	</script>
	<!-- Snackbar -->
	<div id="osc--snackbar" class="mdl-js-snackbar mdl-snackbar">
		<div class="mdl-snackbar__text"></div>
		<button class="mdl-snackbar__action" type="button"></button>
	</div>
	<script>
		function showSnackbar(text) {
			'use strict';
			var snackbarContainer = document.querySelector('#osc--snackbar');
			// showSnackbarButton.style.backgroundColor = '#' +
			// 	Math.floor(Math.random() * 0xFFFFFF).toString(16);
			var data = {
				message: text,
				timeout: 5000,
				actionText: 'OK'
			};
			snackbarContainer.MaterialSnackbar.showSnackbar(data);
		};
	</script>
</body>